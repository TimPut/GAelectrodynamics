%
% Copyright © 2016 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%{
\index{Green's function}

\subsection{Motivation.}

We will now introduce Green's functions, which provide a general method of solving many of the linear differential equations that will be encountered in electromagnetism.

One such linear differential equation is the inhomogeneous wave equation

\begin{dmath}\label{eqn:gradientGreensFunctionEuclidean:162}
\lr{ \spacegrad^2 - \inv{c^2} \PDSq{t}{} } F(\Bx, t) = B(\Bx, t)
\end{dmath}

The time harmonic (frequency domain) representation of the wave equation can be found by assuming a that fixed frequency solution exists.
In complex notation, that means that we can assume that all sources and fields have a complex exponential time dependence of the form
\footnote{This is the engineering convention for the time dependence.
The reader must take care when reading the literature, since some authors (notably in physics) use the opposite sign convention
\( F(\Bx, t) = \Real\lr{ F(\Bx) e^{-i \omega t }} \).}

\index{time harmonic}
\index{frequency domain}
\begin{dmath}\label{eqn:gradientGreensFunctionEuclidean:60}
F(\Bx, t) = \Real\lr{ F(\Bx) e^{j \omega t} },
\end{dmath}

where \( j \) is a scalar imaginary that need not be represented by any geometrical imaginary such as \( \Be_{123}, \Be_{12}, \cdots \).
After substitution of the time harmonic representation into \cref{eqn:gradientGreensFunctionEuclidean:162}, the problem is reduced to finding a solution that is a function of space and time to one that is purely spatial

\begin{dmath}\label{eqn:gradientGreensFunctionEuclidean:159}
\lr{ \spacegrad^2 + \frac{\omega^2}{c^2} } F(\Bx) = B(\Bx).
\end{dmath}

Superposition of discrete or continuous combinations of fixed frequency solutions, once found, can be used to determine more general solutions to the original wave equation \cref{eqn:gradientGreensFunctionEuclidean:162}.

We will writing \( \omega^2/c^2 = k^2 \), to obtain the standard form of the Helmholtz equation we wish to solve

\index{Helmholtz equation}
\index{second order Helmholtz equation}
\begin{dmath}\label{eqn:gradientGreensFunctionEuclidean:160}
\lr{ \spacegrad^2 + k^2 } F(\Bx) = B(\Bx).
\end{dmath}

This is a linear differential equation that is second order with respect to the gradient.
Despite employing a complex representations of the fields and sources, our vector basis is still a real valued Euclidean basis, and we will have no reason to introduce complex inner products spaces into the mix.
We will also encounter statics problems that have no time dependence in electromagnetism.
Some of these problems have the structure of \cref{eqn:gradientGreensFunctionEuclidean:160} with \( k = 0 \), and for those problems the fields and sources are real.

\index{Helmholtz operator}
Observe that the Helmholtz operator can be factored into operators that are first order in the gradient

\begin{dmath}\label{eqn:gradientGreensFunctionEuclidean:161}
\lr{ \spacegrad - j k }\lr{ \spacegrad + j k } F(\Bx) = B(\Bx).
\end{dmath}

We will see that the time harmonic Maxwell's equation, in its GA form, is a first order equation in the gradient of the form

\index{first order Helmholtz equation}
\begin{dmath}\label{eqn:gradientGreensFunctionEuclidean:180}
\lr{ \spacegrad + j k } F(\Bx) = J(\Bx),
\end{dmath}

where \( F \) is a (complex) 1,2 multivector, and \( J \) is a (complex) multivector containing all the charge and current density contributions.
Our initial goal is to develop the Green's function toolbox that can be used to solve first and second order Helmholtz equations of the form
\cref{eqn:gradientGreensFunctionEuclidean:180} and
\cref{eqn:gradientGreensFunctionEuclidean:160} respectively.

\subsection{Unbounded superpositions.}

We can utilize \cref{eqn:gradientGreensFunctionEuclidean:160} to illustrate the Green's function technique.
As this equation is a linear differential operator relating the wave and the driving sources,
it is reasonable to assume that the solution also has a general linear structure, such as

\begin{dmath}\label{eqn:gradientGreensFunctionEuclidean:100}
F(\Bx) = \int dV' B(\Bx') G(\Bx, \Bx') + F_0(\Bx),
\end{dmath}

where the function \( G(\Bx, \Bx') \) is called the Green's function for the Helmholtz operator, and \( F_0 \) is any particular solution to the inhomogeneous Helmholtz equation \( \lr{ \spacegrad^2 + k^2 } F_0 = 0 \).
Operating on \cref{eqn:gradientGreensFunctionEuclidean:100} with the Helmholtz operator \( \spacegrad + k^2 \) we find that the Green's function must
satisfy

\begin{dmath}\label{eqn:gradientGreensFunctionEuclidean:140}
\lr{ \spacegrad^2 + k^2 } G(\Bx, \Bx') = \delta(\Bx - \Bx').
\end{dmath}

While it is possible \citep{schwinger1998classical} to derive the Green's function using Fourier transform techniques, we will state the result instead, which is well known

\index{Helmholtz!Green's function}
\index{Green's function!Helmholtz}
\maketheorem{Green's function for the Helmholtz operator.}{thm:gradientGreensFunctionEuclidean:3}{
The advancing (causal), and the receding (acausal) Green's functions satisfying
\cref{eqn:gradientGreensFunctionEuclidean:140} are respectively

\begin{equation*}
\begin{aligned}
G_{\textrm{adv}}(\Bx, \Bx') &= -\frac{e^{-j k \Norm{ \Bx - \Bx' } }}{ 4 \pi \Norm{\Bx - \Bx'}} \\
G_{\textrm{rec}}(\Bx, \Bx') &= -\frac{e^{j k \Norm{ \Bx - \Bx' } }}{ 4 \pi \Norm{\Bx - \Bx'}}.
\end{aligned}
\end{equation*}
} % theorem

We will use the causal Green's function, and refer to this function as \( G(\Bx, \Bx') \) without any subscript.
A demonstration that these Green's function representations are valid can be found in \cref{chap:helmholtzGreens}.

\index{Laplacian!Green's function}
\index{Green's function!Laplacian}
Observe that as a special case, the Helmholtz Green's function reduces to the Green's function for the Laplacian when \( k = 0 \)

\begin{dmath}\label{eqn:gradientGreensFunctionEuclidean:80}
G(\Bx, \Bx') = -\inv{ 4 \pi \Norm{\Bx - \Bx'}}.
\end{dmath}

\subsection{Bounded superpositions.}

When the presumed solution is a superposition of only states in a bounded region, such as

\begin{dmath}\label{eqn:gradientGreensFunctionEuclidean:200}
F(\Bx) = \int_V dV' B(\Bx') G(\Bx, \Bx') + F_0(\Bx),
\end{dmath}

then life gets a bit more interesting.
For such problems, we require Green's theorem, which must be generalized slightly for use with multivector fields.
The basic idea is that we can relate the Laplacian's of the Green's function and the field
\( F(\Bx') (\spacegrad')^2 G(\Bx, \Bx') = G(\Bx, \Bx') (\spacegrad')^2 F(\Bx') + \cdots \).
That relation is usually expressed in terms of the difference of the two in the integral domain

\maketheorem{Green's theorem}{thm:gradientGreensFunctionEuclidean:220}{
Given a multivector function \( F \) and a scalar function \( G \)
\begin{equation*}
\int_V \lr{ F \spacegrad^2 G - G \spacegrad^2 F } dV = \int_{\partial V} \lr{ F \ncap \cdot \spacegrad G - G \ncap \cdot \spacegrad F },
\end{equation*}
where \( \partial V \) is the boundary of the volume \( V \).
} % theorem

A straightforward, but perhaps inelligant way of proving this theorem is to expand the sandwich difference in coordinates

\begin{dmath}\label{eqn:gradientGreensFunctionEuclidean:260}
F \spacegrad^2 G - G \spacegrad^2 F
=
\sum_k F \partial_k \partial_k G - G \partial_k \partial_k F
=
\sum_k \partial_k \lr{
F \partial_k G - G \partial_k F
}
-
(\partial_k F)(\partial_k G) + (\partial_k G)(\partial_k F).
\end{dmath}

Since \( G \) is a scalar, the last two terms cancel, and we can integrate

\begin{dmath}\label{eqn:gradientGreensFunctionEuclidean:280}
\int_V \lr{ F \spacegrad^2 G - G \spacegrad^2 F } dV
=
\sum_k \int_V \partial_k \lr{ F \partial_k G - G \partial_k F }.
\end{dmath}

Each integral above involves one component of the gradient.
From the fundamental theorem \cref{thm:fundamentalTheoremOfCalculus:1}
we know that
\begin{dmath}\label{eqn:gradientGreensFunctionEuclidean:300}
\int_V \spacegrad Q dV = \int_{\partial V} \ncap Q dA,
\end{dmath}

for any multivector \( Q \).
Equating components gives

\begin{dmath}\label{eqn:gradientGreensFunctionEuclidean:340}
\int_V \partial_k Q dV = \int_{\partial V} \ncap \cdot \Be_k Q dA,
\end{dmath}

which can be substituted into \cref{eqn:gradientGreensFunctionEuclidean:280} to find

\begin{dmath}\label{eqn:gradientGreensFunctionEuclidean:360}
\int_V \lr{ F \spacegrad^2 G - G \spacegrad^2 F } dV
=
\sum_k \int_{\partial V} \ncap \cdot \Be_k \lr{ F \partial_k G - G \partial_k F } dA
=
\int_{\partial V} \lr{ F (\ncap \cdot \spacegrad) G - G (\ncap \cdot \spacegrad) F } dA,
\end{dmath}

which proves the theorem.
For our application of
{thm:gradientGreensFunctionEuclidean:3} to the Helmholtz problem, we
are actually interested in a antisymmetric sandwich of the Helmholtz operator by the function \( F \) and the scalar (Green's) function \( G \), but
that reduces to a sandwich of Laplacian's

\begin{dmath}\label{eqn:gradientGreensFunctionEuclidean:240}
F \lr{ \spacegrad^2 + k^2 } G - G \lr{ \spacegrad^2 + k^2 } F
=
F \spacegrad^2 G + \cancel{F k^2 G} - G \spacegrad^2 F - \cancel{G k^2 F}
=
F \spacegrad^2 G - G \spacegrad^2 F,
\end{dmath}

so

\begin{dmath}\label{eqn:gradientGreensFunctionEuclidean:380}
\int_V F(\Bx') \lr{ (\spacegrad')^2 + k^2 } G(\Bx, \Bx')
=
\int_V G(\Bx, \Bx') \lr{ (\spacegrad')^2 + k^2} F(\Bx') dV'
+
\int_{\partial V} \lr{ F(\Bx') (\ncap' \cdot \spacegrad') G(\Bx, \Bx') - G(\Bx, \Bx') (\ncap' \cdot \spacegrad') F(\Bx') } dA'
\end{dmath}

This shows that if we assume the Green's function satisfies the delta function condition
\cref{eqn:gradientGreensFunctionEuclidean:140}
that was also true for the unbounded case, then the general solution to \cref{eqn:gradientGreensFunctionEuclidean:160}, is

\begin{dmath}\label{eqn:gradientGreensFunctionEuclidean:400}
F(\Bx) =
\int_V G(\Bx, \Bx') B( \Bx' ) dV'
+
\int_{\partial V} \lr{
 G(\Bx, \Bx') (\ncap' \cdot \spacegrad') F(\Bx')
-F(\Bx') (\ncap' \cdot \spacegrad') G(\Bx, \Bx')
} dA'.
\end{dmath}

We are also free to add in any specific solution \( F_0(\Bx) \) that satisfies the
homogeneous Helmholtz equation.
There is also freedom to add any solution of the homogeneous Helmholtz equation to the Green's function itself, so it is not unique.
For a bounded superposition we generally desire that the solution \( F \) and its normal derivative, or the Green's function \( G \) (and it's normal derivative) or an appropriate combination of the two are zero on the boundary, so that the surface integral is killed.

\subsection{First order gradient Green's functions.}

\index{gradient!Green's function}
\index{Green's function!gradient representation}
%The Green's function for the Laplacian of the Green's function is well known, but there are advantages to utilizing the Green's function for first order gradient equations directly.

\maketheorem{Green's function for the gradient}{thm:gradientGreensFunctionEuclidean:1}{

%A sufficient convergence constraint for \( F \) over the infinite sphere is
For a
multivector function \( F \) in a Euclidean space that tends to zero at infinity at least as fast as
\begin{equation*}
\lim_{\Bx' \rightarrow \infty} \frac{\Norm{F(\Bx')}}{\Norm{\Bx - \Bx'}^{n-1}} \rightarrow 0,
\end{equation*}

the
first order multivector gradient equation
\begin{equation*}
\spacegrad' F(\Bx') = M(\Bx'),
\end{equation*}

has an inverse
\begin{equation*}
F(\Bx) = \int_V dV' G(\Bx,\Bx') M(\Bx').
\end{equation*}

Here \( G \) is the Green's function for the gradient over an infinite spherical boundary, satisfying
\begin{equation*}
   \spacegrad G = \spacegrad \cdot G = \delta(\Bx - \Bx'),
\end{equation*}

and is given by
\begin{equation*}
   G(\Bx, \Bx') = \inv{S_n} \frac{\Bx - \Bx'}{\Norm{\Bx-\Bx'}^n}.
\end{equation*}

Here \( n \) is the dimension of the space, \( S_n \) is the area of the unit sphere.
} % theorem

Conventions for the sign of Green's functions or the parameters in the convolution integral often vary.
The sign convention used here is that of \citep{doran2003gap}.

%This result applies not only to gradient equations in Euclidean spaces, but also to multivector (or even just vector) fields \( F \), instead of the usual scalar functions that we usually apply Green's functions to.
Note that the statement that
\( \spacegrad G = \spacegrad \cdot G \), or \( \rspacegrad G = G \lspacegrad \), implies that the curl of the Green's function must be zero.

The proof of this theorem will be left to \cref{chap:gradientGreensFunctionProof}.

%}
